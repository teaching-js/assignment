<!DOCTYPE html>
<html>
    <head>
        <!-- styling for the test results -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/3.1.0/mocha.min.css" />
    </head>
    <body>
        <!-- container that will display test results -->
        <div id="mocha"></div>

        <!-- mocha (test runner) -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/3.1.0/mocha.min.js"></script>

        <!-- chai (assertion library) -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/3.5.0/chai.min.js"></script>

        <script>
            // setup test helpers
            mocha.setup('bdd');
            // Assumes api is running on localhost:5000
            const API_URL = 'http://localhost:5000'

            // all these tests should return 400 requests
            // as long as they're not 500 we're okay.
            describe('Basic GETs', function() {
                it('/user', function() {
                    return fetch(`${API_URL}/user`).then(response => {
                        chai.assert(response.status < 500 && !response.ok);
                    })
                });

                it('/post', function() {
                    return fetch(`${API_URL}/post`).then(response => {
                        chai.assert(response.status < 500 && !response.ok);
                    })
                });

                it('/user/feed', function() {
                    return fetch(`${API_URL}/user/feed`).then(response => {
                        chai.assert(response.status < 500 && !response.ok);
                    })
                });
            });


            describe('Auth Routes', function() {
                it('/auth/login', function() {
                    return fetch(`${API_URL}/auth/login`, {
                        method: 'POST',
                        body: JSON.stringify({})
                    })
                    .then(response => {
                        chai.assert(response.status < 500 && !response.ok);
                    })
                });

                it('/auth/signup', function() {
                    return fetch(`${API_URL}/auth/signup`, {
                        method: 'POST',
                        body: JSON.stringify({})
                    })
                    .then(response => {
                        chai.assert(response.status < 500 && !response.ok);
                    })
                });
            });

            describe('PUTs/POSTs', function() {
                it('/user', function() {
                    return fetch(`${API_URL}/user/`, {
                        method: 'PUT',
                        body: JSON.stringify({})
                    }).then(response => {
                        chai.assert(response.status < 500 && !response.ok);
                    })
                });

                it('/user/follow', function() {
                    return fetch(`${API_URL}/user/follow`, {
                        method: 'PUT',
                        body: JSON.stringify({})
                    }).then(response => {
                        chai.assert(response.status < 500 && !response.ok);
                    })
                });

                it('/post', function() {
                    return fetch(`${API_URL}/post/`, {
                        method: 'POST',
                        body: JSON.stringify({})
                    }).then(response => {
                        chai.assert(response.status < 500 && !response.ok);
                    })
                });
            });
            // run tests
            mocha.run();
        </script>
    </body>
</html>
